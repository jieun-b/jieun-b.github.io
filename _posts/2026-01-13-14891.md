---
title: "[백준] 14891번: 톱니바퀴"
date: 2026-01-13 20:00:00 +0900
layout: post
categories: [공부, Algorithm]
tags: [구현, 시뮬레이션]
---
## 문제

[14891**번: 톱니바퀴**](https://www.acmicpc.net/problem/14891)

### 문제 요약

- 톱니바퀴 4개가 일렬로 있고, 각 톱니바퀴는 **8개의 톱니**를 가짐
- 각 톱니는 **N극(0)** 또는 **S극(1)**
- 총 `K`번 회전하며, 각 회전은 (톱니바퀴 번호 `1~4`, 방향 `1` 또는 `-1`)로 주어짐
    - `1` : 시계 방향으로 한 칸 회전
    - `-1` : 반시계 방향으로 한 칸 회전
- 회전 전파 규칙:
    - 인접한 두 톱니바퀴의 **맞닿은 톱니 극이 다르면**, 옆 톱니바퀴는 **반대 방향**으로 회전
    - 극이 같으면 회전하지 않으며, 전파도 그 지점에서 멈춤
- 모든 회전 후 점수:
    - 1번~4번 톱니바퀴의 **12시 방향(인덱스 0)**이 S극(1)이면 각각 `1, 2, 4, 8`점을 얻고, N극(0)이면 0점


## 풀이 아이디어

### 1. 톱니바퀴 표현

- 각 톱니바퀴를 `deque`로 저장하면 `rotate(±1)`로 한 칸 회전을 쉽게 처리 가능
- 인덱스 의미(코드 기준):
    - `wheels[i][0]` : 12시 방향
    - `wheels[i][2]` : 오른쪽 맞닿는 톱니(3시 방향)
    - `wheels[i][6]` : 왼쪽 맞닿는 톱니(9시 방향)

### 2. 회전 전파(재귀)

- 특정 톱니바퀴 `idx`를 `dir`로 돌릴 때, 실제 회전 여부는 **회전 전 상태의 맞닿는 극 비교**로 결정
- 왼쪽 전파(`left`):
    - `wheels[idx][2] != wheels[idx+1][6]` 이면 더 왼쪽으로 전파하고(`-dir`), 현재 톱니바퀴를 `dir`로 회전
- 오른쪽 전파(`right`):
    - `wheels[idx][6] != wheels[idx-1][2]` 이면 더 오른쪽으로 전파하고(`-dir`), 현재 톱니바퀴를 `dir`로 회전

### 3. 명령 처리 순서

- 각 명령마다
    1. `left(idx-1, -dir)`로 왼쪽 톱니바퀴들의 회전 처리
    2. `right(idx+1, -dir)`로 오른쪽 톱니바퀴들의 회전 처리
    3. 마지막에 기준 톱니바퀴 `wheels[idx].rotate(dir)` 수행

### 4. 점수 계산

- 최종적으로 `res += wheels[i][0] * (2**i)`로 합산


    
## 코드

```python
import sys
from collections import deque
input = sys.stdin.readline

# 톱니바퀴의 상태 / 12시 방향부터 시계 방향
wheels = [deque(list(map(int, input().strip()))) for _ in range(4)]
# 회전 횟수
k = int(input())
# 회전 방법
info = [list(map(int, input().split())) for _ in range(k)]

# 회전 함수 정의
def left(idx, dir):
    if idx < 0:
        return
    if wheels[idx][2] != wheels[idx+1][6]:
        left(idx-1, -dir)
        wheels[idx].rotate(dir)

def right(idx, dir):
    if idx > 3:
        return
    if wheels[idx][6] != wheels[idx-1][2]:
        right(idx+1, -dir)
        wheels[idx].rotate(dir)

# 회전 시작
for idx, dir in info:
    idx -= 1
    left(idx-1, -dir)
    right(idx+1, -dir)
    wheels[idx].rotate(dir)

# 최종 결과는 각 톱니 바퀴의 idx=0의 값 * 2**idx
res = 0
for i in range(4):
    res += wheels[i][0] * (2**i)
print(res)
```